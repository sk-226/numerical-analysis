function expanded_table = expand_results_table(results_summary)
    % expand_results_table - expand results table. (temporary)
    %
    % Input:
    %   results_summary - original table (check exp_cmp_preconditioner.m)
    %
    % Output:
    %   expanded_table - expanded table
    
    % get number of rows
    n_rows = height(results_summary);
    
    % initialize arrays for expanded data
    matrix_names = cell(n_rows, 1);
    matrix_sizes = zeros(n_rows, 1);
    preconditioners = cell(n_rows, 1);
    precon_times = zeros(n_rows, 1);
    iter_finals = zeros(n_rows, 1);
    is_convergeds = zeros(n_rows, 1);
    solve_times = zeros(n_rows, 1);
    true_relres_2s = zeros(n_rows, 1);
    final_relres_2s = zeros(n_rows, 1);
    final_relerr_2s = zeros(n_rows, 1);
    final_relerr_As = zeros(n_rows, 1);
    
    % process each row
    for i = 1:n_rows
        % get basic information
        matrix_names{i} = results_summary.Var1{i};
        matrix_sizes{i} = results_summary.Var2{i};
        preconditioners{i} = results_summary.Var3(i);
        precon_times(i) = results_summary.Var4(i);
        
        % expand struct
        result_struct = results_summary.Var5{i};
        
        % get fields
        iter_finals(i) = result_struct.iter_final;
        is_convergeds(i) = result_struct.is_converged;
        solve_times(i) = result_struct.time;
        true_relres_2s(i) = result_struct.true_relres_2;
        
        % hist_*の末尾値を取りこ得
        final_relres_2s(i) = result_struct.hist_relres_2(end);
        final_relerr_2s(i) = result_struct.hist_relerr_2(end);
        final_relerr_As(i) = result_struct.hist_relerr_A(end);
    end
    
    % 新しいテーブルを作成
    expanded_table = table(...
        matrix_names, ...
        matrix_sizes, ...
        preconditioners, ...
        precon_times, ...
        iter_finals, ...
        is_convergeds, ...
        solve_times, ...
        true_relres_2s, ...
        final_relres_2s, ...
        final_relerr_2s, ...
        final_relerr_As, ...
        'VariableNames', {...
            'Matrix', ...
            'MatrixSize', ...
            'Preconditioner', ...
            'PreconTime', ...
            'Iterations', ...
            'Converged', ...
            'SolveTime', ...
            'TrueRelRes2', ...
            'FinalRelRes2', ...
            'FinalRelErr2', ...
            'FinalRelErrA' ...
        });
end
