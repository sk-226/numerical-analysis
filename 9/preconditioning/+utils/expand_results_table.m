function expanded_table = expand_results_table(results_summary)
    % expand_results_table - 結果テーブルの構造体を展開して見やすくする
    %
    % Input:
    %   results_summary - 元のテーブル（Var4に構造体を含む）
    %
    % Output:
    %   expanded_table - 展開されたテーブル
    
    % 行数を取得
    n_rows = height(results_summary);
    
    % 展開後のデータを格納する配列を初期化
    matrix_names = cell(n_rows, 1);
    preconditioners = cell(n_rows, 1);
    precon_times = zeros(n_rows, 1);
    iter_finals = zeros(n_rows, 1);
    is_convergeds = zeros(n_rows, 1);
    solve_times = zeros(n_rows, 1);
    true_relres_2s = zeros(n_rows, 1);
    final_relres_2s = zeros(n_rows, 1);
    final_relerr_2s = zeros(n_rows, 1);
    final_relerr_As = zeros(n_rows, 1);
    
    % 各行を処理
    for i = 1:n_rows
        % 基本情報を取得
        matrix_names{i} = results_summary.Var1{i};
        preconditioners{i} = results_summary.Var2(i);
        precon_times(i) = results_summary.Var3(i);
        
        % 構造体を展開
        result_struct = results_summary.Var4{i};
        
        % 各フィールドを取得
        iter_finals(i) = result_struct.iter_final;
        is_convergeds(i) = result_struct.is_converged;
        solve_times(i) = result_struct.time;
        true_relres_2s(i) = result_struct.true_relres_2;
        
        % hist_*の末尾値を取得
        final_relres_2s(i) = result_struct.hist_relres_2(end);
        final_relerr_2s(i) = result_struct.hist_relerr_2(end);
        final_relerr_As(i) = result_struct.hist_relerr_A(end);
    end
    
    % 新しいテーブルを作成
    expanded_table = table(...
        matrix_names, ...
        preconditioners, ...
        precon_times, ...
        iter_finals, ...
        is_convergeds, ...
        solve_times, ...
        true_relres_2s, ...
        final_relres_2s, ...
        final_relerr_2s, ...
        final_relerr_As, ...
        'VariableNames', {...
            'Matrix', ...
            'Preconditioner', ...
            'PreconTime', ...
            'Iterations', ...
            'Converged', ...
            'SolveTime', ...
            'TrueRelRes2', ...
            'FinalRelRes2', ...
            'FinalRelErr2', ...
            'FinalRelErrA' ...
        });
end
